<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>Fetch API ì‹¤ìŠµ</title>
    <style>
      body {
        font-family: sans-serif;
        line-height: 1.6;
        padding: 20px;
      }
      .container {
        max-width: 800px;
        margin: auto;
      }
      .box {
        background-color: #f9f9f9;
        border: 1px solid #ddd;
        padding: 15px;
        margin-bottom: 20px;
        border-radius: 5px;
      }
      h1,
      h2 {
        border-bottom: 2px solid #eee;
        padding-bottom: 10px;
      }
      code {
        background-color: #e4e4e4;
        padding: 2px 5px;
        border-radius: 3px;
      }
      button {
        padding: 10px 15px;
        font-size: 16px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Fetch API ìƒì„¸ ê°€ì´ë“œ</h1>

      <div class="box">
        <h2>1. ê°œë… ì„¤ëª…</h2>
        <p>
          Fetch APIëŠ” JavaScriptë¥¼ ì‚¬ìš©í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ë³´ë‚´ê³  ì‘ë‹µì„ ë°›ì„
          ìˆ˜ ìˆëŠ” í˜„ëŒ€ì ì¸ ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤. ê³¼ê±°ì˜ XMLHttpRequestì— ë¹„í•´ í›¨ì”¬
          ê°„ê²°í•˜ê³  ê°•ë ¥í•˜ë©°, Promiseë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ì—¬ ë¹„ë™ê¸° ì½”ë“œë¥¼ ì‰½ê²Œ ë‹¤ë£°
          ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </p>
      </div>

      <div class="box">
        <h2>2. ì£¼ìš” ê¸°ëŠ¥/ì˜µì…˜ ì„¤ëª…</h2>
        <p>
          <code>fetch()</code> í•¨ìˆ˜ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë‘ ê°œì˜ ì¸ìë¥¼ ë°›ìŠµë‹ˆë‹¤:
          <code>fetch(resource, options)</code>
        </p>
        <ul>
          <li>
            <strong>resource (URL)</strong>: ìš”ì²­ì„ ë³´ë‚¼ ì£¼ì†Œì…ë‹ˆë‹¤. (í•„ìˆ˜)
          </li>
          <li>
            <strong>options (ê°ì²´)</strong>: ìš”ì²­ì— ëŒ€í•œ ì¶”ê°€ ì„¤ì •ì…ë‹ˆë‹¤. (ì„ íƒ)
          </li>
          <ul>
            <li>
              <code>method</code>: HTTP ìš”ì²­ ë©”ì„œë“œ (ì˜ˆ: 'GET', 'POST', 'PUT',
              'DELETE'). ê¸°ë³¸ê°’ì€ 'GET'ì…ë‹ˆë‹¤.
            </li>
            <li>
              <code>headers</code>: ìš”ì²­ í—¤ë”. ë°ì´í„° í˜•ì‹('Content-Type') ë“±ì„
              ì§€ì •í•©ë‹ˆë‹¤.
            </li>
            <li>
              <code>body</code>: ìš”ì²­ê³¼ í•¨ê»˜ ë³´ë‚¼ ë°ì´í„°. 'POST'ë‚˜ 'PUT' ìš”ì²­ ì‹œ
              ì£¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.
            </li>
          </ul>
        </ul>
      </div>

      <div class="box">
        <h2>3. ì‹¤ì œ ì‹¤ìŠµ</h2>
        <p>
          ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•˜ê³  ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬(F12)ì˜ Console íƒ­ì„ í•¨ê»˜
          í™•ì¸í•˜ì„¸ìš”.
        </p>
        <button id="fetch-btn">ë°ì´í„° ìš”ì²­</button>
      </div>
    </div>

    <script>
      /*
        ==================================================================================
        ğŸ¯ 1. ê°œë… ì„¤ëª…
        ==================================================================================
        1. API (Application Programming Interface) ë€?
           - 'ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í”„ë¡œê·¸ë˜ë°í•˜ê¸° ìœ„í•œ ê·œì¹™ì˜ ì§‘í•©'ì…ë‹ˆë‹¤.
           - ì‰½ê²Œ ë¹„ìœ í•˜ë©´, ì‹ë‹¹ì˜ 'ë©”ë‰´íŒ'ê³¼ ê°™ìŠµë‹ˆë‹¤. ì†ë‹˜(í´ë¼ì´ì–¸íŠ¸)ì€ ë©”ë‰´íŒ(API ë¬¸ì„œ)ì„ ë³´ê³ 
             ì •í•´ì§„ ë°©ì‹ëŒ€ë¡œ ì£¼ë¬¸(ìš”ì²­)í•´ì•¼ ì£¼ë°©(ì„œë²„)ì—ì„œ ìš”ë¦¬(ë°ì´í„°)ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
           - `https://jsonplaceholder.typicode.com/todos/1`ëŠ” "1ë²ˆ í•  ì¼ ì •ë³´ë¥¼ ì£¼ì„¸ìš”"ë¼ëŠ” ì•½ì†ëœ ì£¼ì†Œ(API Endpoint)ì…ë‹ˆë‹¤.
        2. fetch ë€?
           - APIë¼ëŠ” ì‹ë‹¹ì— 'ì£¼ë¬¸(ë„¤íŠ¸ì›Œí¬ ìš”ì²­)'ì„ ë„£ëŠ” í–‰ìœ„ ìì²´ì…ë‹ˆë‹¤.
           - JavaScriptì— ë‚´ì¥ëœ í•¨ìˆ˜ì´ë©°, Promise ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•©ë‹ˆë‹¤.
        3. Promise (í”„ë¡œë¯¸ìŠ¤) ë€?
           - 'ì–¸ì  ê°€ ê²°ê³¼ë¥¼ ì£¼ê² ë‹¤'ëŠ” ì•½ì† ì¦ì„œì™€ ê°™ìŠµë‹ˆë‹¤.
           - fetchë¥¼ ì‹¤í–‰í•˜ë©´ ì¦‰ì‹œ ë°ì´í„°ê°€ ì˜¤ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, 'Promise'ë¼ëŠ” ì•½ì† ì¦ì„œë¥¼ ë¨¼ì € ë°›ìŠµë‹ˆë‹¤.
           - ì´ ì•½ì†ì˜ ìƒíƒœëŠ” 3ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.
             - pending (ëŒ€ê¸°): ì•„ì§ ì•½ì†ì´ ì´í–‰ë˜ì§€ ì•Šì€ ìƒíƒœ (ìš”ì²­ì„ ë³´ë‚´ê³  ê¸°ë‹¤ë¦¬ëŠ” ì¤‘)
             - fulfilled (ì´í–‰): ì•½ì†ì´ ì„±ê³µì ìœ¼ë¡œ ì´í–‰ëœ ìƒíƒœ (ì„œë²„ê°€ ì‘ë‹µì„ ì¤Œ)
             - rejected (ê±°ì ˆ): ì•½ì†ì´ ì‹¤íŒ¨í•œ ìƒíƒœ (ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ë“±)
        4. .then() ê³¼ .catch()
           - .then(callback): Promiseê°€ fulfilled(ì„±ê³µ) ìƒíƒœê°€ ë˜ë©´ ì‹¤í–‰í•  ì½”ë“œë¥¼ ë“±ë¡í•˜ëŠ” ê³³ì…ë‹ˆë‹¤.
             "ì•½ì†ì´ ì§€ì¼œì§€ë©´(then) ì´ê±¸ ì‹¤í–‰í•´ì¤˜" ë¼ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.
           - .catch(callback): Promiseê°€ rejected(ì‹¤íŒ¨) ìƒíƒœê°€ ë˜ë©´ ì‹¤í–‰í•  ì½”ë“œë¥¼ ë“±ë¡í•˜ëŠ” ê³³ì…ë‹ˆë‹¤.
             "ì•½ì†ì´ ê¹¨ì§€ë©´(catch) ì´ê±¸ ì‹¤í–‰í•´ì¤˜" ë¼ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.
        5. Response ê°ì²´ì™€ .json()
           - fetchì˜ ì²« ë²ˆì§¸ .then()ìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” ê²ƒì€ ìµœì¢… ë°ì´í„°ê°€ ì•„ë‹Œ 'Response' ê°ì²´ì…ë‹ˆë‹¤.
           - ë¹„ìœ í•˜ìë©´, ì£¼ë¬¸í•œ ìŒì‹ì´ 'í¬ì¥ëœ ìƒíƒœ'ë¡œ ë„ì°©í•œ ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤.
           - ì´ í¬ì¥(Response) ì•ˆì—ëŠ” ì‹¤ì œ ìŒì‹(ë°ì´í„°)ë¿ë§Œ ì•„ë‹ˆë¼, ìƒíƒœ ì½”ë“œ(200 OK ë“±), í—¤ë” ì •ë³´ ë“±ì´ ë‹´ê²¨ìˆìŠµë‹ˆë‹¤.
           - .json() ë©”ì„œë“œëŠ” ì´ í¬ì¥ì„ í’€ì–´ ì‹¤ì œ ìŒì‹(JSON ë°ì´í„°)ì„ êº¼ë‚´ëŠ” í–‰ìœ„ì…ë‹ˆë‹¤.
           - ë°ì´í„°ë¥¼ êº¼ë‚´ëŠ” ê³¼ì •(.json()) ì—­ì‹œ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬ë˜ë¯€ë¡œ, Promiseë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ë’¤ì— .then()ì„ í•œ ë²ˆ ë” ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
        */

      document
        .getElementById("fetch-btn")
        .addEventListener("click", async () => {
          /*
            ==================================================================================
            ğŸ¯ 3. ì‹¤ì œ ì‹¤ìŠµ
            ==================================================================================
            ìš”êµ¬ì‚¬í•­:
            1. 'https://jsonplaceholder.typicode.com/todos/1' ì£¼ì†Œë¡œ fetch ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤.

            2. ì‘ë‹µì´ ì„±ê³µí•˜ë©´(response.ok), ì‘ë‹µ ë³¸ë¬¸ì„ JSONìœ¼ë¡œ íŒŒì‹±í•©ë‹ˆë‹¤.
            3. íŒŒì‹±ëœ ë°ì´í„°ì—ì„œ 'title' ì†ì„±ì„ ë½‘ì•„ alert ì°½ìœ¼ë¡œ ë„ì›ë‹ˆë‹¤.
            4. ìš”ì²­ ê³¼ì •ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´, í•´ë‹¹ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ alert ì°½ìœ¼ë¡œ ë„ì›ë‹ˆë‹¤.
            */
          // ğŸ§‘â€ğŸ’» ì—¬ê¸°ì— ì½”ë“œë¥¼ ì‘ì„±í•˜ì„¸ìš”.
          const url = `https://jsonplaceholder.typicode.com/todos/1`;
          try {
            const response = await fetch(url);
            console.log(response);
            if (response.ok) {
              // const text = await response.text();
              // console.log(text);
              // JSON.parse(...)
              const data = await response.json(); // í•œ ë²ˆì—...
              console.log(data);
              // alert(data["title"]);
              alert(data.title);
            } else {
              throw new Error("ìš”ì²­ ì—ëŸ¬ ë°œìƒ");
            }
          } catch (error) {
            alert(error.message);
          }
        });
    </script>
  </body>
</html>
